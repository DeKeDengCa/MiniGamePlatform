syntax = "proto3";

package comm.mgr.customer;

option go_package = "gitit.cc/social/protobuf/gencode/mgr/pbmcustomer";

import "protobuf/api/customer/complaint.proto";
// smicro:spath=gitit.cc/social/components-service/social-customersvc/biz/complaint/handler-mgr/complaintMgr

service ComplaintMgr {
    // 操作申诉分类
    rpc OperateCategory(OperateCategoryReq) returns (OperateCategoryRsp);

    // 操作申诉类型数据
    rpc OperateComplaintType(OperateComplaintTypeReq) returns (OperateComplaintTypeRsp);

    // 操作FAQ数据
    rpc OperateFAQ(OperateFAQReq) returns (OperateFAQRsp);

    // 展示用户申诉列表
    rpc ListComplaints(ListComplaintsReq) returns (ListComplaintsRsp);

    // 修改申诉分类,申诉类型
    rpc UpdateCategory(UpdateCategoryReq) returns (UpdateCategoryRsp);

    // 更新回复用户申诉工单
    rpc AddReply(AddReplyReq) returns (AddReplyRsp);

    // 查询申诉类型
    rpc SearchComplaintType(SearchComplaintTypeReq) returns (SearchComplaintTypeRsp);

    // pkg
    rpc ListPkg(ListPkgReq) returns (ListPkgRsp);

    // 批量更新申诉工单状态
    rpc UpdateState(UpdateStateReq) returns (UpdateStateRsp);

    // 批量查询用户信息
    rpc BatchUserInfos(BatchUserInfosReq) returns (BatchUserInfosRsp);

    // 操作关键词
    rpc OperateKeyword(OperateKeywordReq) returns (OperateKeywordRsp);

    // 操作关键词语种
    rpc ListKeywordLan(ListKeywordLanReq) returns (ListKeywordLanRsp);

    // 国家列表
    rpc ListCountry(ListCountryReq) returns (ListCountryRsp);

    // 更新回复用户申诉工单
    rpc Tracking(TrackingReq) returns (TrackingRsp);
}

message SearchComplaintTypeReq {
    int64 complaint_category_id =1; // 分类ID
    string anm = 2; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
    string sub_anm = 3; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
}

message SearchComplaintTypeRsp {
    repeated ComplaintType complaint_types = 1; // 申诉类型详情
}

message ListPkgReq {
    repeated State states =5; // 状态数组,审核记录{1,3} 审核列表{2,4}
    string anm = 6; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
    string sub_anm = 7; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
}

message ListPkgRsp {
    repeated string name =1; //pkg名称
}

message UpdateStateReq {
    repeated int64 id =1;// 记录id
    State state =2; // 更新状态
    string operator = 3; // 操作人
    string anm = 4; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
    string sub_anm = 5; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
}

message UpdateStateRsp {
}

message Pagination {
    int64 page =1;//页码
    int64 pageSize =2; //页数
    int64 count =3;//总数
}

enum Operate {
    OPERATE_NONE = 0; // 无
    OPERATE_CREATE =1 ; // 创建
    OPERATE_UPDATE =2 ; // 更新
    OPERATE_SEACH = 3; // 查询
}

// 相关分类枚举
enum CategoryType {
    CATEGORY_TYPE_NONE = 0; // 无
    CATEGORY_TYPE_PAY = 1; // 支付类型 
    CATEGORY_TYPE_OTHERS = 2; // 其他类型
    CATEGORY_TYPE_Withdraw = 3; // 提现类型
}

message Category {
    int64 id =1 ;// 分类id
    string name =2; // 投诉类型 名称中文
    string created_by =3; // 创建人
    string updated_by =4; // 编辑人
    int64 created_at =5; // 创建时间
    int64 updated_at =6; // 更新时间
    string name_ar =7; // 投诉类型 名称阿语
    string name_tr =8; // 投诉类型 名称土耳其
    string name_en =9; // 投诉类型 名称英语
    CategoryType category_type =10; // 类型枚举
}

message ComplaintType {
    int64 id =1 ;// 申诉类型id
    int64 complaint_category_id =2; // 分类ID
    string type_text =3; //申诉类型多语言中文
    string icon =4 ;// icon
    bool is_visible =5 ;// 是否显示在投诉页
    string remark =6; // 备注
    string created_by =7; // 创建人
    string updated_by =8; // 编辑人
    int64 created_at =9; // 创建时间
    int64 updated_at =10; // 更新时间
    int32 sort =11; // 排序
    string icon_dark = 12 ;// 黑暗模式 icon
    string type_text_ar =13; // 申诉类型多语言阿语
    string type_text_tr =14; // 申诉类型多语言土耳其
    int32 is_delete =15; // 是否删除 1已删除 2未删除
    string type_text_en =16; //申诉类型多语言英语
}

message OperateCategoryReq {
    Operate operate =1 ; // 操作类型
    Pagination pagination =2; //分页
    Category category =3 ;// 分类详情
    string anm =4 ; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
    string sub_anm = 5; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
}

message OperateCategoryRsp {
    repeated Category categorys =1; //分类列表
    Pagination pagination =2; //分页
}

message SearchComplaintParams {
    string  key =1 ;// 申诉类型搜索
    int64  complaint_category_id =2 ;// 分类ID
    int32  is_visible = 3; // 是否展示 0所有,1展示,2不展示 
    bool   is_all =4;// 是否获取所有有效的申诉类型
    int64  id =5 ;// 申诉类型ID
    int32  is_delete =6; // 是否删除 1已删除 2未删除
    int32  use_sort =7; // 权重排序 0不排序 1升序 2降序
}

message OperateComplaintTypeReq {
    Operate operate =1 ; // 操作类型
    Pagination pagination =2; //分页
    ComplaintType complaint_type =3;// 申诉详情
    SearchComplaintParams params = 4; // 搜索参数
    string anm = 5; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
    string sub_anm = 6; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
}

message OperateComplaintTypeRsp {
    repeated ComplaintType detail =1 ;// 申诉详情
    Pagination pagination =2; //分页
}

message FAQ {
    int64 complaint_type_id =1 ;// 申诉类型id
    int64 sort =2; //排序
    string question =3;// 英文
    string question_ar =4;// 阿语
    string question_tr =5;// 土耳其
    string answer =6;// 英文
    string answer_ar =7;// 阿语
    string answer_tr =8;// 土耳其
    repeated string answer_images=9;// 英文图片
    repeated string answer_images_ar=10;// 阿语图片
    repeated string answer_images_tr=11;// 土耳其图片
    string remark = 12;//备注
    string created_by =13; // 创建人
    string updated_by =14; // 编辑人
    int64 created_at =15; // 创建时间
    int64 updated_at =16; // 更新时间
    int32 state = 17;// 数据状态 1:正常 2:已删除
    int64 id = 18; //主键ID
    ComplaintType complaint_type_info = 19; //申诉类型详情
    repeated string pkgs = 20;  // 包名
}

message SearchFAQParams {
    int64  complaint_type_id =1 ;// 申诉类型ID
    string  question_key =2 ;// 问题关键词
    int32  state = 3; // 数据状态 0:所有 1:正常 2:已删除
    repeated string pkgs = 20;  // 包名
}

message OperateFAQReq {
    Operate operate =1 ; // 操作类型
    Pagination pagination =2; //分页
    FAQ faq =3 ;// FAQ详情
    SearchFAQParams params =4; // 查询参数
    string anm = 5; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
    string sub_anm = 6; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
}

message OperateFAQRsp {
    Pagination pagination =2; //分页
    repeated FAQ faq =3 ;// FAQ详情列表
}

// 支付相关
message PayType {
    string method = 1 ; // 支付方式
    int64 time = 2 ;// 支付时间 秒
    string number = 3; // 订单号
    repeated string screenshots = 4; // 支付截图
    string platform_order_id = 5; // 平台订单号
}

// 普通相关
message CommonType {
    string  detail =1 ; // 问题描述
    int64 time =2 ;// 问题时间 秒
    string system_prompt = 3; // 系统提示文案
    repeated string picture =4; //图片上传
}

// 提现相关
message WithdrawType {
    string  detail =1 ; // 问题描述
    int64 time =2 ;// 问题时间 秒
    string number = 3; // 订单号
    repeated string statement =4; //pdf格式
}

enum State {
    STATE_NONE = 0; //无
    STATE_RESOLVED= 1; // 已通过
    STATE_PROCESSING= 2; // 处理中
    STATE_INVALID =3; // 拒绝
    STATE_PENDING =4; // 挂起
}

// 用户角色
enum UserRole {
    USER_ROLE_NONE = 0;
    USER_ROLE_NORMAL = 1; // 普通用户
    USER_ROLE_GUILD = 2;  // 公会长
}

message Complaint {
    int64 id =1 ;// 工单号
    int64 uid =2; // 用户ID
    int64 complaint_type_id =3 ;// 申诉类型id
    int64 complaint_category_id =4; // 分类ID 
    State state = 5; //工单状态
    PayType pay_info =6 ;// 支付相关信息
    CommonType  common_info =7; // 常规相关的信息
    WithdrawType withdraw_info=8; // 提现相关的信息
    string pkg =9; // pkg包名
    int64 submit_time =10 ;// 提交时间
    int64 operator_time =11 ; // 处理时间
    string operator =12 ; // 处理人
    UserInfo user_info =13; // 用户信息
    int32 validity = 14; // 1:有效 2:无效
    int64 complaint_num =15; // 申诉次数
    ComplaintType complaint_type_info =16; //申诉类型详情
    UserRole user_role = 17; // 用户角色
    bool reply_status = 18; // 回复状态
    TrackingStatus tracking_status = 19; // 跟踪状态
    repeated comm.api.customer.Reply replies = 20;  // 回复内容
    string did = 21;                                // 设备ID
    map<string, string> contacts = 22;              // 联系方式，key取值：whatsapp等等
}

enum WealthSection {
    WEALTH_SECTION_NONE = 0 ;
    WEALTH_SECTION_UNDER_SIX = 1 ; // [0-6]
    WEALTH_SECTION_ABOVE_SIX = 2 ; // > 6
}

// track 状态
enum TrackingStatus {
    TRACKING_STATUS_NONE = 0;           // none
    TRACKING_STATUS_NO_TRACKE = 1;      // no track
    TRACKING_STATUS_TRACKING = 2;       // tracking
    TRACKING_STATUS_NULL = 3;           // 空值
}

message SearchRecordParams {
    int64  uid =1 ;// 用户UID
    string  pkg =2 ;// pkg包名
    int64  complaint_type_id =3 ;// 申诉类型ID
    int64  category_id =4 ;// 分类ID
    repeated State states =5; // 状态数组,审核记录{1,3} 审核列表{2,4}
    int32 validity = 6; // 1:有效 2:无效
    int64 submit_start_time = 7; // 提交开始时间
    int64 submit_end_time = 8; // 提交结束时间
    string country = 9; // 国家
    string issue_desc = 10; // 问题描述
    UserRole user_role = 11; // 用户角色
    repeated bool reply_status = 12; // 回复状态,为空时则都展示。查询已回复，填[true]
    TrackingStatus tracking_status = 13; // 跟踪状态
    WealthSection wealth_section = 14; // 财富等级
    repeated int64 complaint_type_ids = 15 ;   // 申诉类型ID
    string did = 16;                           // 设备ID
}

message ListComplaintsReq {
    Pagination pagination =1; //分页
    SearchRecordParams params= 2; // 查询参数
    bool need_user =3; // 是否需要用户信息
    string anm = 4; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
    string sub_anm = 5; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
}

message ListComplaintsRsp {
    repeated Complaint complaints =1; //记录列表 
    Pagination pagination =2; //分页
}

message UpdateCategoryReq{
    repeated int64 complaint_id =1 ;// 工单号
    int64 complaint_category_id =2; // 分类ID
    int64 complaint_type_id =3; // 申诉类型ID
    string anm = 4; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
    string sub_anm = 5; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
}

message UpdateCategoryRsp{
}

message AddReplyReq {
    repeated int64 complaint_id =1 ;// 工单号
    string content =2 ;// 回复内容
    repeated string images =3; // 回复图片
    string created_by =4; // 创建人
    string updated_by =5; // 编辑人    
    string anm = 6; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要） 
    string sub_anm = 7; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
}

message AddReplyRsp{
}

message BatchUserInfosReq {
    repeated int64 uids =1 ;// 用户uid
    string anm = 2; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
    string sub_anm = 3; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
}

message UserInfo {
    int64 uid = 1; // 用户ID 
    string nickname = 2; // 用户昵称
    int32 gender = 3; // 性别 1:男2:女3:无性别
    string avatar = 4; // 头像
    string show_uid = 5; // 靓号
    int32 age = 6; // 年龄
    string birthday = 7; // 生日
    string country = 8; // 国家
    int64 wealth_level =9; //财富等级
    int64 register_time =10 ; // 注册时间
    int64 last_login_time = 11; // 最后登录时间
    string version =12; // 当前版本号
    string pkg =13; // 包名
    UserRole user_role = 14; // 用户角色
}

message BatchUserInfosRsp {
    repeated UserInfo list =1; // 用户详情列表
}

message SearchKeywordParams {
    int64 id = 1;// id
    string keyword = 2;// 关键词
    string lan = 3;// 语种
    int32 state = 4;// 数据状态 1:正常 2:已删除
}

message Keyword {
    int64 id = 1; // ID
    string word = 2; // 关键词
    string lan = 3; // 语种
    string created_by = 4; // 创建人
    string updated_by = 5; // 编辑人
    int64 created_at =6; // 创建时间
    int64 updated_at =7; // 更新时间
    int32 state = 8;// 数据状态 1:正常 2:已删除
}

message OperateKeywordReq {
    Operate operate =1 ; // 操作类型
    Pagination pagination =2; //分页
    Keyword keyword =3 ;// 详情
    SearchKeywordParams params = 4; // 搜索参数
    string anm = 5; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
    string sub_anm = 6; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
}

message OperateKeywordRsp {
    repeated Keyword detail =1 ;// 详情
    Pagination pagination =2; //分页
}

message Lan {
    string text = 1; // 语种名称(展示用)
    string name = 2; // 语种简称(新增,查询传递服务端)
}

message ListKeywordLanReq {
    string anm = 1; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
    string sub_anm = 2; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
}

message ListKeywordLanRsp {
    repeated Lan lans =1; // 语种列表
}

message ListCountryReq {
    string anm = 1; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
    string sub_anm = 2; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
}

message ListCountryRsp {
    repeated string countries = 1; // 国家列表
}

message TrackingReq {
    repeated int64 complaint_id = 1 ;// 工单号
    bool tracking = 2;  // 是否tracking
    string operator = 3; // 操作人
    string anm = 4; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
    string sub_anm = 5; // 针对同域名不同anm的情况下需要的参数（通常情况下不需要）
}
message TrackingRsp{
}