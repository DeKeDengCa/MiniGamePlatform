syntax = "proto3";

package pbsocialgoldagency;

import "protobuf/api/adapter/model.proto";

option go_package = "gitit.cc/social/protobuf/gencode/svr/pbsocialgoldagency";

// 币商交易类型
enum TransactionType {
  TRANSACTION_TYPE_NONE = 0;              // 无意义
  TRANSACTION_TYPE_RECHARGE = 10;         // 充值, 币商充值
  TRANSACTION_TYPE_DEDUCTION = 20;        // 扣减, 系统扣减
  TRANSACTION_TYPE_TRANSFER = 30;         // 转让, 转给一级币商
  TRANSACTION_TYPE_DISTRIBUTION = 40;     // 分销, 转给二级币商
  TRANSACTION_TYPE_RETAIL = 50;           // 零售, 转给用户, 也相当于用户充值.
}

// 币商交易消息
// 业务 topic: social-goldagency-transaction-message-${anm}
// 中台 topic: social-goldagency-transaction-message-social
message TransactionMsg {
  string anm = 1;                                 // 业务名
  string sub_anm = 2;                             // 业务子代号
  TransactionType transaction_type = 3;           // 交易类型
  string seq_id = 4;                              // 唯一ID
  int64 ts = 5;                                   // 时间戳
  BalanceChange agency_balance_change = 6;        // 币商余额变动
  BalanceChange opposite_balance_change = 7;      // 对方余额变动, 在转让/分销/零售这 3 个交易类型中才有值.
}

// 余额变动类型
enum BalanceChangeType {
  BALANCE_CHANGE_TYPE_NONE = 0;
  BALANCE_CHANGE_TYPE_INCREASE = 10;              // 余额增加
  BALANCE_CHANGE_TYPE_DECREASE = 20;              // 余额减少
}

// 余额变动
message BalanceChange {
  int64 uid = 1;                                  // 用户UID
  comm.api.adapter.Currency currency = 2;         // 货币类型
  BalanceChangeType type = 3;                     // 变动类型
  int64 quantity = 4;                             // 变动数额(不会有负数)
}
